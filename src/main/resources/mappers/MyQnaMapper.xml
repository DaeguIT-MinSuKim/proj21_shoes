<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="proj21_shoes.mapper.MyQnaMapper">

	<!-- resultMap type : dto 클래스명 , id : 외부에서 지정할이름? -->
	<!-- result column : db속 컬럼명, property : dto속 변수명 -->

 <resultMap type="NormalQnARegistCommand" id="registQna">	
 	<id column="board_code" property="boardCode" />						<!-- 게시판코드 -->		
		<result column="member_code" property="memberCode" />				<!-- 회원코드	 -->	
		<result column="title" property="title" />							<!-- 제목 -->
		<result column="content" property="content" />						<!-- 내용 -->
		<result column="reply" property="reply" />							<!-- 답글 -->
		<result column="regist_date" property="registDate" />				<!-- 작성일 -->
	</resultMap>
	 <resultMap type="ModifyMyNormalQnA" id="updateQna">	
 	<id column="board_code" property="boardCode" />						<!-- 게시판코드 -->		
		<result column="member_code" property="memberCode" />				<!-- 회원코드	 -->	
		<result column="title" property="title" />							<!-- 제목 -->
		<result column="content" property="content" />						<!-- 내용 -->
		<result column="reply" property="reply" />							<!-- 답글 -->
		<result column="regist_date" property="registDate" />				<!-- 작성일 -->
	</resultMap>

 	 <resultMap type="MyQnaViewCommand" id="resQna">			
		<id column="board_code" property="boardCode" />						<!-- 게시판코드 -->		
		<result column="member_code" property="memberCode" />				<!-- 회원코드	 -->
		<result column="member_id" property="memberId" />					<!-- 회원아이디 -->
		<result column="product_code" property="productCode" />				<!-- 상품코드	 -->
		<result column="product_name" property="productName" />				<!-- 상품명	 -->
		<result column="product_main_image" property="productMainImage" />	<!-- 상품 대표이미지-->
		<result column="title" property="title" />							<!-- 제목 -->
		<result column="content" property="content" />						<!-- 내용 -->
		<result column="reply" property="reply" />							<!-- 답글 -->
		<result column="regist_date" property="registDate" />				<!-- 작성일 -->
	</resultMap>
	
	<!-- 상품문의만!!  (상품코드 입력해서문의했을떄) -->
	 
	<select id="selectProductQnAbyId" resultMap="resQna">
	select board_code, member_code, member_id, product_code, product_name,product_main_image, title, content, regist_date 		
	from vw_myqna where member_id=#{memberId} and product_code is not null;
	
	</select>
	<select id="selectProductQnAbyBoardCode" resultMap="resQna">
	select board_code, member_code, member_id, product_code, product_name, product_main_image, title, content, regist_date		
	from vw_myqna where board_code=#{boardCode} and product_code is not null;
	<!-- 상품문의만!!  (상품코드 입력해서문의했을떄) -->
	</select> 
	
		<select id="selectNormalQnAbyId" resultMap="resQna">
	select board_code, member_code, member_id, product_code, product_name,product_main_image, title, content, regist_date 		
	from vw_myqna where member_id=#{memberId} and product_code is null;
	
	</select>
	<select id="selectNormalQnAbyBoardCode" resultMap="resQna">
	select board_code, member_code, member_id, product_code, product_name, product_main_image, title, content, regist_date		
	from vw_myqna where board_code=#{boardCode} and product_code is null;
	<!-- 상품문의만!!  (상품코드 입력해서문의했을떄) -->
	</select> 
	
	<insert id="insertNormalQnA" >
		insert into qna  
		(member_code, product_code, title, content, reply, regist_date)
		VALUES(#{memberCode}, null, #{title}, #{content}, #{reply}, now());
	</insert>
	<update id="updateNormalQnA">
		UPDATE qna
		SET  title=#{title}, content=#{content}
		WHERE board_code=#{boardCode};
	</update>
	
	 
	 
	 <!-- select만으로 하려했던것 ㅠ -->
<!-- 	<select id="selectbyId" resultMap="resQna">
	select board_code, 
	member_code,product_code,
	(select product_name from product where product_code=#{productCode})as product_name,
	 title,content,reply,regist_date 		
	from qna where member_code =(select member_code from member where member_id =#{memberId}) ;
	
	</select>
	<select id="selectbyBoardCode" resultMap="resQna">
	select board_code, 
	member_code,product_code,
	(select product_name from product where product_code=#{productCode})as product_name,
	 title,content,reply,regist_date 		
	from qna where member_code =(select member_code from member where board_code =#{board_Code}) ;
	
	</select> -->
	
</mapper>



